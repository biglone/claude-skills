---
name: data-analyzer
description: 数据分析，包括数据解读、统计分析、趋势发现。当用户要求分析数据、解读报表、发现规律时使用。
allowed-tools: Read, Bash
---

# 数据分析助手

## 分析流程

### 1. 理解数据
- 数据来源和背景
- 数据字段含义
- 数据质量评估
- 时间范围确认

### 2. 探索性分析
- 基本统计描述
- 数据分布情况
- 异常值识别
- 缺失值处理

### 3. 深入分析
- 相关性分析
- 趋势分析
- 对比分析
- 细分分析

### 4. 洞察提炼
- 关键发现
- 业务建议
- 后续行动

## 基础统计

### 描述性统计
```
集中趋势：
- 平均值 (Mean): 所有值的算术平均
- 中位数 (Median): 排序后的中间值
- 众数 (Mode): 出现最频繁的值

离散程度：
- 标准差 (Std): 数据分散程度
- 方差 (Variance): 标准差的平方
- 范围 (Range): 最大值 - 最小值
- 四分位距 (IQR): Q3 - Q1

分布形态：
- 偏度 (Skewness): 分布对称性
- 峰度 (Kurtosis): 分布尖锐程度
```

### Python 实现
```python
import pandas as pd
import numpy as np

# 基本统计
df.describe()

# 详细统计
print(f"平均值: {df['column'].mean():.2f}")
print(f"中位数: {df['column'].median():.2f}")
print(f"标准差: {df['column'].std():.2f}")
print(f"最小值: {df['column'].min()}")
print(f"最大值: {df['column'].max()}")

# 分位数
print(f"25%分位: {df['column'].quantile(0.25)}")
print(f"75%分位: {df['column'].quantile(0.75)}")

# 相关性
df.corr()
```

## 分析类型

### 1. 趋势分析
```
目的：识别数据随时间的变化模式

关注点：
- 上升/下降趋势
- 季节性波动
- 周期性变化
- 异常点

方法：
- 时间序列图
- 移动平均
- 同比/环比增长率
```

### 2. 对比分析
```
目的：比较不同组/时期的差异

维度：
- 时间对比：本月 vs 上月，今年 vs 去年
- 群体对比：A组 vs B组，新用户 vs 老用户
- 目标对比：实际 vs 计划，本公司 vs 行业

指标：
- 绝对差值
- 相对变化率
- 百分比份额
```

### 3. 细分分析
```
目的：分解数据，找出影响因素

维度举例：
- 用户：年龄、地区、来源渠道
- 产品：品类、价格段、SKU
- 时间：小时、日、周、月

方法：
- 分组统计
- 交叉分析
- 漏斗分析
```

### 4. 相关性分析
```
目的：发现变量之间的关联

相关系数解读：
- 0.8-1.0: 强相关
- 0.5-0.8: 中等相关
- 0.3-0.5: 弱相关
- 0-0.3: 极弱或无相关

注意：相关不等于因果！
```

## 常用指标

### 增长指标
```
同比增长率 = (本期 - 去年同期) / 去年同期 × 100%
环比增长率 = (本期 - 上期) / 上期 × 100%
复合增长率 (CAGR) = (终值/初值)^(1/年数) - 1
```

### 用户指标
```
DAU: 日活跃用户
MAU: 月活跃用户
留存率 = 第N天仍活跃用户 / 首日新增用户
流失率 = 1 - 留存率
LTV: 用户生命周期价值
```

### 电商指标
```
转化率 = 成交用户 / 访问用户
客单价 = 总销售额 / 订单数
复购率 = 重复购买用户 / 总购买用户
GMV: 总交易额
```

### 财务指标
```
毛利率 = (收入 - 成本) / 收入
净利率 = 净利润 / 收入
ROI = (收益 - 成本) / 成本
```

## 数据质量检查

```python
# 缺失值检查
df.isnull().sum()
df.isnull().sum() / len(df) * 100  # 缺失率

# 重复值检查
df.duplicated().sum()

# 异常值检查 (IQR 方法)
Q1 = df['column'].quantile(0.25)
Q3 = df['column'].quantile(0.75)
IQR = Q3 - Q1
outliers = df[(df['column'] < Q1 - 1.5*IQR) |
              (df['column'] > Q3 + 1.5*IQR)]

# 数据类型检查
df.dtypes

# 唯一值检查
df['column'].nunique()
df['column'].value_counts()
```

## 分析报告模板

```markdown
# [主题] 数据分析报告

## 摘要
[1-2 句话概括主要发现]

## 背景
- 分析目的
- 数据来源
- 时间范围
- 样本量

## 关键发现

### 发现 1: [标题]
[具体描述 + 数据支持]

### 发现 2: [标题]
[具体描述 + 数据支持]

### 发现 3: [标题]
[具体描述 + 数据支持]

## 详细分析

### 整体概况
[整体数据描述]

| 指标 | 数值 | 变化 |
|------|------|------|

### 趋势分析
[时间维度分析]

### 细分分析
[分组/分类分析]

## 结论与建议

### 结论
1. [结论1]
2. [结论2]

### 建议
1. [建议1]
2. [建议2]

## 附录
- 数据定义
- 分析方法说明
- 详细数据表
```

## 输出格式

分析数据时，输出包含：
1. **数据概况**：样本量、时间范围、关键指标
2. **关键发现**：3-5 个重要洞察
3. **数据支持**：具体数字和百分比
4. **可视化建议**：适合的图表类型
5. **行动建议**：基于数据的建议
